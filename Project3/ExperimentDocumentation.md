

# poseidon2哈希算法
## 初始化

将初始状态 $I$ 设为全0向量。输入消息 $m = m_{1}||m_{2}||\cdots || m_{n}$ ， 每个消息分块都是固定长度的有限域元素向量，输出为 $h = h_{1}||h_{2}||\cdots || h_{n}$

## 吸收阶段

1. 赋值 $IV \leftarrow m_{1}$

2. 执行置换函数 $P$ ，包括 $R_{F}$ 轮全轮和 $R_{P}$ 轮部分轮组成

3. 将置换后的结果与 $m_{2}$ 进行异或操作，得到新的状态

4. 重复上述操作，直至所有消息块均被处理

## 置换阶段

### 全轮

1. ARC：对状态向量中的每个元素加上一个预先定义的常量

$$x_{i}\leftarrow x_{i}+c_{i}$$

2. S盒：对每个元素进行非线性变换

3. M：将状态向量与一个预先定义的 MDS（Maximum Distance Separable）矩阵进行乘法操作，实现线性变换

$$x\leftarrow M\cdot x$$

### 部分轮

部分轮的操作与全轮类似，但通常只对状态向量中的第一个元素进行 ARC 和 S盒 操作，其余元素仅进行线性变换

## 压缩阶段

经过吸收阶段和置换阶段后，从最终的状态向量中提取哈希输出